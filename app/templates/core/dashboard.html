<!-- app/templates/core/dashboard.html -->
{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <h1 class="display-5">Dashboard</h1>
        <p class="lead">Welcome to CoreSecFrame Web Interface</p>
        <hr>
    </div>
</div>

<div class="row mb-4">
    <!-- System Info -->
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-header bg-primary text-white">
                <h5 class="card-title mb-0">System Information</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label">CPU Usage</label>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: {{ system_info.cpu_percent }}%;"
                            aria-valuenow="{{ system_info.cpu_percent }}" aria-valuemin="0" aria-valuemax="100">
                            {{ system_info.cpu_percent }}%
                        </div>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Memory Usage</label>
                    <div class="progress">
                        <div class="progress-bar bg-success" role="progressbar"
                            style="width: {{ system_info.memory_percent }}%;"
                            aria-valuenow="{{ system_info.memory_percent }}" aria-valuemin="0" aria-valuemax="100">
                            {{ system_info.memory_percent }}%
                        </div>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Disk Usage</label>
                    <div class="progress">
                        <div class="progress-bar bg-warning" role="progressbar"
                            style="width: {{ system_info.disk_percent }}%;"
                            aria-valuenow="{{ system_info.disk_percent }}" aria-valuemin="0" aria-valuemax="100">
                            {{ system_info.disk_percent }}%
                        </div>
                    </div>
                </div>
                <div class="mt-3">
                    <p><strong>Hostname:</strong> {{ system_info.hostname }}</p>
                    <p><strong>Platform:</strong> {{ system_info.platform }}</p>
                    <p><strong>Python Version:</strong> {{ system_info.python_version }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modules Info -->
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-header bg-success text-white">
                <h5 class="card-title mb-0">Modules</h5>
            </div>
            <div class="card-body">
                <div class="row text-center mb-4">
                    <div class="col-4">
                        <h4>{{ modules_info.total }}</h4>
                        <small>Total</small>
                    </div>
                    <div class="col-4">
                        <h4>{{ modules_info.installed }}</h4>
                        <small>Installed</small>
                    </div>
                    <div class="col-4">
                        <h4>{{ modules_info.available }}</h4>
                        <small>Available</small>
                    </div>
                </div>

                <div class="list-group">
                    {% for category in modules_info.categories %}
                    <a href="{{ url_for('modules.category', name=category.name) }}"
                        class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        {{ category.name }}
                        <span class="badge bg-primary rounded-pill">{{ category.count }}</span>
                    </a>
                    {% else %}
                    <div class="text-center">
                        <p>No modules found</p>
                        <a href="{{ url_for('modules.shop') }}" class="btn btn-sm btn-primary">Browse Module Shop</a>
                    </div>
                    {% endfor %}
                </div>
            </div>
            <div class="card-footer">
                <a href="{{ url_for('modules.index') }}" class="btn btn-outline-success btn-sm w-100">Manage Modules</a>
            </div>
        </div>
    </div>

    <!-- Sessions Info -->
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-header bg-info text-white">
                <h5 class="card-title mb-0">Sessions</h5>
            </div>
            <div class="card-body">
                <div class="row text-center mb-4">
                    <div class="col-4">
                        <h4>{{ sessions_info.total }}</h4>
                        <small>Total</small>
                    </div>
                    <div class="col-4">
                        <h4>{{ sessions_info.active }}</h4>
                        <small>Active</small>
                    </div>
                    <div class="col-4">
                        <h4>{{ sessions_info.inactive }}</h4>
                        <small>Inactive</small>
                    </div>
                </div>

                <div class="list-group">
                    {% for session in sessions_info.recent %}
                    <a href="{{ url_for('sessions.view', session_id=session.session_id) }}"
                        class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        {{ session.name }}
                        <span
                            class="badge {% if session.active %}bg-success{% else %}bg-danger{% endif %} rounded-pill">
                            {% if session.active %}Active{% else %}Inactive{% endif %}
                        </span>
                    </a>
                    {% else %}
                    <div class="text-center">
                        <p>No active sessions</p>
                        <a href="{{ url_for('terminal.index') }}" class="btn btn-sm btn-primary">Start New Terminal</a>
                    </div>
                    {% endfor %}
                </div>
            </div>
            <div class="card-footer">
                <a href="{{ url_for('sessions.index') }}" class="btn btn-outline-info btn-sm w-100">Manage Sessions</a>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- Quick Actions -->
    <div class="col-md-12">
        <div class="card">
            <div class="card-header bg-dark text-white">
                <h5 class="card-title mb-0">Quick Actions</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <a href="{{ url_for('terminal.new') }}" class="btn btn-outline-primary btn-lg w-100">
                            <i class="bi bi-terminal"></i> New Terminal
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{{ url_for('modules.shop') }}" class="btn btn-outline-success btn-lg w-100">
                            <i class="bi bi-cloud-download"></i> Module Shop
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{{ url_for('sessions.index') }}" class="btn btn-outline-info btn-lg w-100">
                            <i class="bi bi-hdd-stack"></i> Sessions
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{{ url_for('core.system_info') }}" class="btn btn-outline-warning btn-lg w-100">
                            <i class="bi bi-info-circle"></i> System Info
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}